// js/foxy/responses.js

import { normalize } from "./utils.js";

// üíÖ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç
export const services = {
  "–∫–æ–º–±–∏ –º–∞–Ω–∏–∫—é—Ä":       "–°–Ω—è—Ç–∏–µ + –∫–æ–º–±–∏-–º–∞–Ω–∏–∫—é—Ä ‚Äî 1000‚ÇΩ.",
  "–º–∞–Ω–∏–∫—é—Ä —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º": "–°–Ω—è—Ç–∏–µ + –∫–æ–º–±–∏ + —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ + –¥–∏–∑–∞–π–Ω ‚Äî –æ—Ç 1700‚ÇΩ.",
  "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª–∏–Ω—ã":      "–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª–∏–Ω—ã –∏ —Ñ–æ—Ä–º—ã ‚Äî 800‚ÇΩ.",
  "–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –Ω–æ–≥—Ç–µ–π":   "–ù–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ + –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ ‚Äî –æ—Ç 2200‚ÇΩ.",
  "—Å–Ω—è—Ç–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è":      "–°–Ω—è—Ç–∏–µ –±–µ–∑ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è ‚Äî 500‚ÇΩ."
};

// üîç –ø–æ–∏—Å–∫ —É—Å–ª—É–≥–∏ –ø–æ —Ç–æ—á–Ω–æ–º—É –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é
export function matchService(text) {
  const input = normalize(text);

  // –ò—Å–∫–ª—é—á–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã/–∏–Ω—Ç–µ–Ω—Ç—ã
  const blocked = ["—É—Å–ª—É–≥–∞", "—É—Å–ª—É–≥–∏", "–¥–∏–∑–∞–π–Ω", "–ø–æ–º–æ—â—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è", "–ø—Ä–∏–≤–µ—Ç"];
  if (blocked.includes(input)) return null;

  // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  for (const key of Object.keys(services)) {
    if (normalize(key) === input) {
      return { name: key, exact: true };
    }
  }

  // –°–∏–Ω–æ–Ω–∏–º—ã
  const aliases = {
    "–∫–æ–º–±–∏": "–∫–æ–º–±–∏ –º–∞–Ω–∏–∫—é—Ä",
    "–º–∞–Ω–∏–∫—é—Ä": "–∫–æ–º–±–∏ –º–∞–Ω–∏–∫—é—Ä",
    "—É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ": "–º–∞–Ω–∏–∫—é—Ä —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º",
    "–ø–æ–∫—Ä—ã—Ç–∏–µ": "–º–∞–Ω–∏–∫—é—Ä —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º",
    "–¥–ª–∏–Ω–∞": "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª–∏–Ω—ã",
    "–¥–ª–∏–Ω—É": "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª–∏–Ω—ã",
    "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è": "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª–∏–Ω—ã",
    "–Ω–∞—Ä–∞—Å—Ç–∏—Ç—å": "–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –Ω–æ–≥—Ç–µ–π",
    "–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ": "–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –Ω–æ–≥—Ç–µ–π",
    "—Å–Ω—è—Ç–∏–µ": "—Å–Ω—è—Ç–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
    "—Å–Ω—è—Ç—å": "—Å–Ω—è—Ç–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è"
  };

  if (aliases[input]) {
    return { name: aliases[input], exact: false };
  }

  // –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  for (const key of Object.keys(services)) {
    const words = normalize(key).split(" ");
    if (words.some(word => input.includes(word))) {
      return { name: key, exact: false };
    }
  }

  return null;
}

// ü¶ä –ø—Ä–æ—Å—Ç–æ–µ —Å–º–∞–π–ª–∏—à—å–∫–æ
export function emoji(mood = "neutral") {
  return "ü¶ä";
}

// üí¨ —à–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤
export const replies = {
  greeting: [
    "–ü—Ä–∏–≤–µ—Ç–∏–∫! –ß—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Å–µ–≥–æ–¥–Ω—è ‚Äî –Ω—é–¥, –±–ª—ë—Å—Ç–∫–∏ –∏–ª–∏ –∫–æ—à–∞—á–∏–π –≥–ª–∞–∑? üòò",
    "–°–∞–ª—é—Ç! –î–∞–≤–∞–π –≤—ã–±–µ—Ä–µ–º —á—Ç–æ-—Ç–æ —Å—Ç–∏–ª—å–Ω–æ–µ –≤–º–µ—Å—Ç–µ üåà"
  ],
  mood: [
    "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Å–ø—Ä–æ—Å–∏–ª(–∞)! –£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ üíÖ",
    "–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî –∫–∞–∫ —Å–≤–µ–∂–∏–π –º–∞–Ω–∏–∫—é—Ä ‚ú®"
  ],
  thanks: ["–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ üòä", "–û–±—Ä–∞—â–∞–π—Å—è –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è üå∏"],
  bye:    ["–î–æ –≤—Å—Ç—Ä–µ—á–∏! –ù–µ –∑–∞–±—ã–≤–∞–π –±–∞–ª–æ–≤–∞—Ç—å —Å–µ–±—è ‚ú®", "–ü–æ–∫–∞-–ø–æ–∫–∞! –ë—É–¥—É –∂–¥–∞—Ç—å üíñ"],
   design: [
    "–î–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –¥–∏–∑–∞–π–Ω–æ–º –Ω–æ–≥—Ç–µ–π –∑–∞–≥–ª—è–Ω–∏ —Å—é–¥–∞: " +
    "<a href=\"https://www.pinterest.com/search/pins/?q=–º–∞–Ω–∏–∫—é—Ä%20–¥–∏–∑–∞–π–Ω\" " +
       "target=\"_blank\" rel=\"noopener noreferrer\" " +
       "class=\"text-pink-500 underline\">Pinterest ‚Äî –¥–∏–∑–∞–π–Ω –æ—Ç –§–æ–∫—Å–∏</a>"
  ],
  fallback: [
    "–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª–∞‚Ä¶ –î–∞–≤–∞–π –≤—ã–±–µ—Ä–µ–º –∏–∑ —Å–ø–∏—Å–∫–∞?",
    "–ß—Ç–æ-—Ç–æ –Ω–µ —É–ª–æ–≤–∏–ª–∞‚Ä¶ –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å üôà"
  ],
  softWarning: ["–ü–æ–ø—Ä–æ–±—É–µ–º –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –≥—Ä—É–±–æ—Å—Ç–µ–π, –ª–∞–¥–Ω–æ? üßº", "–≠–π! –î–∞–≤–∞–π –ø–æ-–¥–æ–±—Ä–æ–º—É üòá"],
  smalltalkLite: ["–û–∫–µ–π üòâ", "–î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å ‚ú®", "–ü–æ–≥–Ω–∞–ª–∏!"],
  styleTalk: [
    "–û, –Ω—é–¥ ‚Äî –≤—Å–µ–≥–¥–∞ –≤ –º–æ–¥–µ! üíÖ",
    "–ë–ª—ë—Å—Ç–∫–∏ –¥–æ–±–∞–≤—è—Ç –æ–≥–Ω—è üî• –•–æ—á–µ—à—å –ø—Ä–∏–º–µ—Ä—ã?",
    "¬´–ö–æ—à–∞—á–∏–π –≥–ª–∞–∑¬ª ‚Äî —à–∏–∫–∞—Ä–Ω—ã–π –≤—ã–±–æ—Ä üòª"
  ],
  about: ["–Ø ‚Äî —Ç–≤–æ–π –º–∞–Ω–∏–∫—é—Ä–Ω—ã–π –≥–∏–¥! –ü–æ–º–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –∏ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è ‚ú®"]
};

export function randomReply(type) {
  const arr = replies[type] || replies.fallback;
  return arr[Math.floor(Math.random() * arr.length)];
}
